#!/bin/sh

# shellcheck source=bin/dotlib
. "$(dirname "$(realpath "$0")")/dotlib"

# Lint and format Fish shell scripts that come with the dotfiles
# (lints all files when no paths are provided)
__dotfiles_cd_root

lint() {
  __print_heading_dimmed "Linting \`$1\`"
  fish_indent --write -- "$1"
  fish --no-execute -- "$1"
}

if [ $# -gt 0 ]; then
  for file in "$@"; do
    lint "$file"
  done
else
  files="$("$DOTFILES_BIN_DIR/dotfiles-dev-ls-fish")"

  printf "%s\n" "$files" \
    | while IFS= read -r file; do
      lint "$file"
    done
fi
