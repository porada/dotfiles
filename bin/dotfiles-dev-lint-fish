#!/bin/sh

# Enable strict mode
set -eu

# Lint Fish shell scripts that come with the dotfiles
# (lint all files when no paths are provided)
DOTFILES_BIN_PATH="$(dirname "$(realpath "$0")")"
cd "$(dirname "$DOTFILES_BIN_PATH")"

lint() {
  echo "$1"
  fish --no-execute -- "$1"
}

if [ $# -gt 0 ]; then
  for file in "$@"; do
    lint "$file"
  done
else
  files="$("$DOTFILES_BIN_PATH/dotfiles-dev-ls-fish")"

  printf '%s\n' "$files" \
    | while IFS= read -r file; do
      lint "$file"
    done
fi
