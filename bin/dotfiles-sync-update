#!/bin/sh

# shellcheck source=bin/dotlib
. "$(dirname "$(realpath "$0")")/dotlib"

# Update `npm` packages
if __is_callable npm; then
  __print_heading 'Updating `npm` packages'

  npm --global --loglevel=error install npm
  npm --global --loglevel=error update
fi

# Update `pnpm` packages
if __is_callable pnpm; then
  __print_heading 'Updating `pnpm` packages'
  pnpm --global update
fi

# Update Vim plugins
if __is_callable vim && __is_vim_plug_installed; then
  __print_heading "Updating Vim plugins"

  if vim -c "PlugUpgrade | PlugUpdate | PlugClean! | quitall"; then
    __print_confirmation "Updated"
  else
    __print_error "Update failed"
  fi
fi

# Update Fish plugins
if __is_callable fish && __is_fisher_installed; then
  __print_heading 'Updating `fisher` plugins'

  if ! fish -c "fisher update"; then
    __print_error "Update failed"
  fi
fi
