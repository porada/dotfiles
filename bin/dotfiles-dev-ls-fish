#!/bin/sh

# Enable strict mode
set -eu

# List all Fish shell scripts that come with the dotfiles
# (POSIX shell scripts can be listed with `dotfiles-dev-ls-sh`)
DOTFILES_BIN_PATH="$(dirname "$(realpath "$0")")"
cd "$(dirname "$DOTFILES_BIN_PATH")"

files="$({
  git ls-files --cached --exclude-standard
  echo extra.fish
} | sort)"

printf '%s\n' "$files" \
  | while IFS= read -r file; do
    if [ ! -e "$file" ] || [ -L "$file" ]; then
      continue
    fi

    if [ "${file##*.}" = "fish" ] || head -n 1 "$file" | grep -q '^#!.*/fish'; then
      echo "${file#./}"
    fi
  done
