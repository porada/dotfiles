#!/bin/sh

# shellcheck source=bin/domlib
. "$(dirname "$(realpath "$0")")/domlib"

# Lint and format POSIX shell scripts that come with domfiles
# (lints all files when no paths are provided)
__domfiles_cd_root

if [ $# -eq 0 ]; then
  __ifs_set
  # shellcheck disable=SC2046
  set -- $("$DOMFILES_BIN_DIR/domfiles-dev-list-sh")
  __ifs_restore
fi

if [ $# -eq 1 ]; then
  __print_heading "Formatting and linting \`$1\`"
else
  __print_heading 'Formatting and linting POSIX shell scripts'
fi

__is_ci || __ pnpm --silent format "$@"
__ shellcheck --external-sources "$@"
