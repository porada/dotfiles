#!/bin/sh

__upgrading() {
  printf "\n\033[1;33mÂ· Upgrading %s\033[0m\n" "$*"
}

# Update dotfiles
if hash git 2> /dev/null && [ -n "$DOTFILES_PATH" ]; then
  __upgrading dotfiles
  git -C "$DOTFILES_PATH" pull
  "$DOTFILES_PATH"/bin/dotfiles-init
fi

# Update Homebrew and installed apps
if hash brew 2> /dev/null; then
  __upgrading brew
  brew_cache_path=`brew --cache`
  brew update && brew upgrade
  brew doctor && brew cleanup -s && rm -rf "$brew_cache_path"
fi

# Update globally installed Node packages
if hash npm 2> /dev/null; then
  __upgrading npm
  npm install --global npm
  npm update --global
fi

# Update Vim plugins
if hash vim 2> /dev/null; then
  __upgrading vim plugins
  vim -c "PlugUpgrade | PlugUpdate | PlugClean! | quitall"
fi

# Update Fish plugins
if hash fish 2> /dev/null; then
  __upgrading fisher
  fish -c "fisher update"
fi
