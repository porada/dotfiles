#!/bin/sh

# shellcheck source=bin/domlib
. "$(dirname "$(realpath "$0")")/domlib"

# List all Fish shell scripts that come with domfiles
__domfiles_cd_root

files="$({
  git ls-files --cached --others --exclude-standard
  echo '.config/fish/local.fish'
} | sort)"

printf '%s\n' "$files" \
  | while IFS= read -r file; do
    if [ ! -e "$file" ] || [ -L "$file" ]; then
      continue
    fi

    if [ "${file##*.}" = 'fish' ] || head -n 1 "$file" | grep -q '#!/usr/bin/env fish'; then
      echo "${file#./}"
    fi
  done
