#!/bin/sh

# shellcheck source=bin/dotlib
. "$(dirname "$(realpath "$0")")/dotlib"

if ! __is_brew_installed; then
  __print_error_and_exit '`brew` needs to be installed before running `dotfiles init`'
fi

__dotfiles init-migrate
__dotfiles init-setup
__dotfiles init-install
__dotfiles init-macos
__dotfiles init-clean

# Skip the rest during an upgrade
if [ "${1-}" = "--upgrade" ]; then
  exit 0
fi

# Finish with dependency status
__print_heading "Setup complete"
__dotfiles dependencies || true
